<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InPatient CBIS</title>

    <!-- Icon Header -->
    <link rel="shortcut icon" type="image/png" href="public/img/front_sample_4.png">

    <!-- Core CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="node_modules/css/main.min.css">

    <!-- Icons CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

</head>
<style>
    section {
        padding: 50px 0px;
    }
    
    .just {
        text-align: justify;
    }
</style>

<body>
    <!-- main page & intro cover -->
    <section id="intro" class="bg-althospital">
        <div class="container-xxl">
            <div class="row justify-content-center align-items-center">
                <div class="col-lg-5 pb-md-5 pt-md-3 col-md-9 text-center text-lg-start text-muted d-block">
                    <h1>
                        <div class="display-2 fw-bold">InPatient CBIS</div>
                    </h1>

                    <!-- image for small media -->
                    <div class="text-center d-block d-lg-none">
                        <span class="tt" data-bs-placement="bottom" title="World without Limit">
                            <img class="img-fluid" src="public/img/front_sample_7.png" alt="">
                        </span>
                    </div>

                    <p class="my-0 pb-4 lead">InPatient Card-Based Billing & Identification System</p>
                    <p class="my-4 d-lg-block d-none text-muted">&raquo; <em>We are proud to serve you in making the place of convenient, convenience for All. </em></p>
                    <!-- <p class="my-4 d-lg-block d-none text-muted">&raquo; <em>Come on Just do it Yourself. </em></p> -->

                    <!-- exploring other possibilities -->
                    <!-- <a class="btn btn-gold d-inline-block bi-view-stacked" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample">
                        Explore
                      </a> -->

                    <!-- <a href="#" class="btn btn-police-dark bi-people d-lg-inline-block d-none" data-bs-toggle="modal" data-bs-target="#aregisterModal" data-bs-whatever="@aregister"><span class="d-lg-inline-block">&nbsp;Land a Job</span></a> -->

                    <!-- <a href="#" class="btn btn-gold bi-buildings d-lg-inline-block d-none" data-bs-toggle="modal" data-bs-target="#bregisterModal" data-bs-whatever="@register"><span class="d-lg-inline-block">&nbsp;Become our patient</span></a> -->

                    <a href="#check" class="btn btn-police-dark bi-eye"> View ID</a>

                    <a href="#signin" class="btn btn-outline-police-dark bi-door-open-fill"> Sign in</a>


                    <!-- Printing alerts -->
                    <?php if($cashier_errorMessage || $cashier_deleteErrorMessage || $update_errorMessage) { ?>
                    <div class="alert alert-warning alert-dismissible fade show alert-danger mt-2" role="alert">
                        <strong class="bi bi-exclamation-triangle"><?php echo $cashier_errorMessage; echo $cashier_deleteErrorMessage; echo $update_errorMessage; echo $busy_errorMessage; ?></strong>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>

                    <?php } ?>

                    <?php if($cashier_successMessage || $cashier_deleteSuccessMessage || $update_successMessage) { ?>
                    <div class="alert alert-success alert-dismissible fade show mt-2" role="alert">
                        <strong class="bi bi-check2-all"><?php echo $cashier_successMessage; echo $cashier_deleteSuccessMessage; echo $update_successMessage; echo $busy_successMessage; ?></strong>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                    <?php } ?>

                </div>

                <!-- tooltip -->
                <div class="col-lg-6 col-md-5 text-center d-none d-lg-block">
                    <span class="tt" data-bs-placement="bottom" title="World without Limit">
                        <img class="img-fluid" src="public/img/front_sample_7.png" alt="">
                    </span>
                </div>
            </div>
        </div>
    </section>

    <!-- login  -->
    <section id="signin" class="">
        <div class="container-lg">
            <div class="text-center text-police-dark">
                <h2>Bills & Identification</h2>
                <p class="lead text-muted">We're glad to have you!</p>
            </div>

            <!-- login row -->
            <div class="row my-5 align-items-center justify-content-center g-0">

                <div class="col-md-5 text-center d-none d-lg-block">
                    <div class="tt" data-bs-placement="bottom" title="Medical - Access info from anywhere">
                        <img class="img-fluid" src="public/img/front_sample_4.png" alt="">
                    </div>
                </div>
                <div class="col-md-1 d-none d-lg-block"></div>

                <!-- login -->
                <div class="col-12 col-md-6 col-lg-5">

                    <?php if($error_message) { ?>
                    <div class="alert alert-warning alert-dismissible fade show alert-danger" role="alert">
                        <strong class="bi bi-exclamation-triangle"><?php echo $error_message; ?></strong>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                    <?php } ?>

                    <div class="card border-police-semi border-2 rounded-4">
                        <div class="card-body text-center py-5">
                            <h4 class="card-title fw-bold text-police-dark">SIGN IN</h4>
                            <p class="card-subtitle p-3 text-body-tertiary small">Signin with your Username and Password</p>

                            <!-- fetch user login credentials -->
                            <form action="" method="post">

                                <!-- your username -->
                                <div class="mb-4 input-group">
                                    <span class="input-group-text text-bg-police-semi"><i class="bi bi-person-circle"></i></span>

                                    <div class="form-floating">
                                        <input type="text" name="username" id="email" class="form-control" placeholder="Username" id="floatingInputGroup1">
                                        <label for="floatingInputGroup1">Username</label>
                                    </div>

                                    <!-- tooltips -->
                                    <div class="input-group-text text-bg-althospital">
                                        <span class="tt" data-bs-placement="bottom" title="Your registered username"><i class="bi bi-question-circle"></i>
                                            </span>
                                    </div>
                                </div>

                                <!-- your key password -->
                                <div class="mb-4 input-group">
                                    <span class="input-group-text text-bg-police-light"><i class="bi bi-key-fill"></i></span>

                                    <div class="form-floating">
                                        <input type="password" name="password" id="email" class="form-control" placeholder="peT@123!nK?" id="floatingInputGroup1">
                                        <label for="floatingInputGroup1">Password</label>
                                    </div>

                                    <!-- tooltips -->
                                    <div class="input-group-text text-bg-althospital">
                                        <span class="tt" data-bs-placement="bottom" title="Your key"><i class="bi bi-question-circle"></i></span>
                                    </div>
                                </div>
                                <a href="#" class="text-danger float-start"><small>forgot password?</a>

                                <button type="submit" class="btn btn-police-dark mt-3 text-altlight bi-door-open-fill float-end" name="signin">&nbsp; Sign in</button>
                            </form>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- placeholders -->
    <section id="check" class="bg-light">
        <div class="container-xxl">
            <div class="text-center text-police-dark">
                <h2>Quick Identification</h2>
                <p class="lead text-muted">Just place your card to the reader!</p>
            </div>
            <div class="row justify-content-center">
                <div class="col-lg-6 col-md-8 col-12">

                    <!-- check the identity and/or bill on card -->
                    <form action="" method="post">
                        <div class="mb-4 input-group">
                            <div class="input-group-text text-bg-police-dark">
                                <i class="bi bi-credit-card-2-front-fill"></i>
                            </div>

                            <!-- getting user card info -->
                            <div class="form-floating">
                                <input type="text" name="patient_id" id="balance" class="form-control" placeholder="Username" id="floatingInputGroup1">
                                <label for="floatingInputGroup1" class="text-body-tertiary">Card ID</label>
                            </div>

                            <!-- printing user identification -->
                            <?php if ($user_detail) { ?>
                            <div class="input-group-text text-bg-success fw-medium">
                                <i class="bi-check-lg"></i>
                            </div>
                            <?php } else { ?>
                            <!-- <div class="input-group-text text-bg-success fw-medium">
                            <i class="bi-check-lg"></i>
                        </div> -->
                            <?php } ?>

                            <!-- tooltips -->
                            <div class="input-group-text">
                                <span class="tt" data-bs-placement="bottom" title="Enter your card id to view user identification!"><i class="bi bi-question-circle"></i>
                                </span>
                            </div>
                        </div>
                    </form>

                    <!-- Printing alerts -->
                    <?php if($cashier_errorMessage || $cashier_deleteErrorMessage || $update_errorMessage || $busy_errorMessage) { ?>
                    <div class="alert alert-warning alert-dismissible fade show alert-danger mt-2" role="alert">
                        <strong class="bi bi-exclamation-triangle"><?php echo $cashier_errorMessage; echo $cashier_deleteErrorMessage; echo $update_errorMessage; echo $busy_errorMessage; ?></strong>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>

                    <?php } ?>

                    <?php if($cashier_successMessage || $cashier_deleteSuccessMessage || $update_successMessage || $busy_successMessage) { ?>
                    <div class="alert alert-success alert-dismissible fade show mt-2" role="alert">
                        <strong class="bi bi-check2-all"><?php echo $cashier_successMessage; echo $cashier_deleteSuccessMessage; echo $update_successMessage; echo $busy_successMessage; ?></strong>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                    <?php } ?>

                    <div class="card" aria-hidden="true">

                        <!-- if user is searched and found -->
                        <?php if ($patientResults) { ?>
                        <div class="card-header bg-police-dark justify-content-between">
                            <h6 class="lead fw-medium text-light">
                                <img src="public/img/user-profile.svg" style="width: 40px;" alt="...">
                                <?php echo $patientResults->patient_name . $patientResults->patient_mname . " " . $patientResults->patient_lname ?>
                                <span class="pt-2 float-end fw-light">ID: <?php echo $patientResults->patient_id ?></span>
                            </h6>
                        </div>
                        <div class="card-body justify-content-between text-capitalize">

                            <?php # getting info about diagnosis fees ...
                                $diagnoseFetchQuery = 'SELECT * FROM `fees_list` WHERE `fees_name` = :fees_name';
                                $diagnoseFetchStatement = $pdo->prepare($diagnoseFetchQuery);
                                $diagnoseFetchStatement->execute([
                                    'fees_name' => 'diagnosis'
                                ]);
                                $diagnoseResults = $diagnoseFetchStatement->fetch();

                                $diagnosis_fee = $diagnoseResults->amount;

                                # getting info about surgery fees ...

                                $surgeryFetchQuery = 'SELECT * FROM `fees_list` WHERE `fees_name` = :fees_name';
                                $surgeryFetchStatement = $pdo->prepare($surgeryFetchQuery);
                                $surgeryFetchStatement->execute([
                                    'fees_name' => 'surgery'
                                ]);
                                $surgeryResults = $surgeryFetchStatement->fetch();

                                $surgery_fee = $surgeryResults->amount;

                                # getting info about consult fees ...

                                $consultFetchQuery = 'SELECT * FROM `fees_list` WHERE `fees_name` = :fees_name';
                                $consultFetchStatement = $pdo->prepare($consultFetchQuery);
                                $consultFetchStatement->execute([
                                    'fees_name' => 'consultation'
                                ]);
                                $consultResults = $consultFetchStatement->fetch();

                                $consult_fee = $consultResults->amount;

                            ?>

                            <!-- Fetch patient resident Location -->
                            <?php # Fetching patient resident Location ...

                                $pID = $patientResults->pID;

                                $patient_location_FetchQuery = 'SELECT * FROM `patient_location` WHERE `pID` = :pID';
                                $patient_location_FetchStatement = $pdo->prepare($patient_location_FetchQuery);
                                $patient_location_FetchStatement->execute([
                                            'pID'  =>  $pID
                                        ]);
                                $patient_location_Result = $patient_location_FetchStatement->fetch();
                            ?>

                            <p class="mb-1 fw-medium">Location:
                                <text class="fw-light">
                                    <?php echo "
                                        <span class='float-end'>".$patient_location_Result->district . " District</span><br>
                                        <span class='float-end'>".$patient_location_Result->sector . " sector</span><br>
                                        <span class='float-end'>".$patient_location_Result->cell . " cell</span><br>
                                        <span class='float-end'>".$patient_location_Result->village . " village</span><br>
                                    "; ?>
                                </text>
                            </p>
                            <hr>

                            <!-- Fetch consultation infos ... -->
                            <?php # Fetching consultation infos location info ...

                                $patient_id = $patientResults->patient_id;

                                $consult_FetchQuery = 'SELECT * FROM `consult_form` WHERE `patient_id` = :patient_id AND `status` = :bstatus';
                                # $consult_FetchQuery = 'SELECT * FROM `consult_form` WHERE `patient_id` = :patient_id';
                                $consult_FetchStatement = $pdo->prepare($consult_FetchQuery);
                                $consult_FetchStatement->execute([
                                            'patient_id'  =>  $patient_id,
                                            'bstatus'     =>  'unpaid'
                                        ]);
                                $consult_Result = $consult_FetchStatement->fetchAll();

                                if ($consult_Result) {
                                
                                foreach ($consult_Result as $key => $consult) {
                            ?>
                            <p class="mb-1 fw-medium">Consultation:
                                <text class="fw-light">
                                    <?php echo "
                                        <span class='float-end text-success fw-bold'>".$consult->complains . " (Complains)</span><br>
                                        <i class='float-end'>". $consult->findings ." (Findings)</i><br>
                                        <i class='float-end'>". $consult->treatment ." (Treatments)</i><br>
                                        <i class='float-end'>". $consult->medecine ." (Medecine)</i><br>
                                        <i class='float-end'>". $consult->medecine ." (Allergy)</i><br>
                                        <i class='float-end text-capitalize text-danger'>". $consult->status ." (". number_format($consult_fee) ." Rwf)</i><br>
                                        <i class='float-end'> On ". $consult->created_on ." at ". $consult->created_at ."</i><br>
                                    "; ?>
                                </text>
                            </p>
                            <hr>
                            <?php } } else { ?>
                            <p class="mb-1 fw-medium">Consultation:
                                <span class="fw-light float-end text-success">None</span>
                            </p>
                            <?php } ?>

                            <!-- Fetch diagnosis infos ... -->
                            <?php # Fetching diagnosis infos location info ...

                                $patient_id = $patientResults->patient_id;

                                $diagnose_FetchQuery = 'SELECT * FROM `diagnose_form` WHERE `patient_id` = :patient_id AND `status` = :bstatus';
                                # $diagnose_FetchQuery = 'SELECT * FROM `diagnose_form` WHERE `patient_id` = :patient_id';
                                $diagnose_FetchStatement = $pdo->prepare($diagnose_FetchQuery);
                                $diagnose_FetchStatement->execute([
                                            'patient_id'  =>  $patient_id,
                                            'bstatus'     =>  'unpaid'
                                        ]);
                                $diagnose_Result = $diagnose_FetchStatement->fetchAll();

                                if ($diagnose_Result) {
                                
                                foreach ($diagnose_Result as $key => $diagnose) {
                            ?>
                            <p class="mb-1 fw-medium">Diagnosis Name:
                                <text class="fw-light">
                                    <?php echo "
                                        <span class='float-end text-success fw-bold'>".$diagnose->diagnose_name . " (Detail)</span><br>
                                        <i class='float-end'>". $diagnose->description ." (Description)</i><br>
                                        <i class='float-end'>". $diagnose->complications ." (Complications)</i><br>
                                        <i class='float-end'>". $diagnose->allergy ." (Allergy)</i><br>
                                        <i class='float-end text-capitalize text-danger'>". $diagnose->status ." (". number_format($diagnosis_fee) ." Rwf)</i><br>
                                        <i class='float-end'> On ". $diagnose->created_on ." at ". $diagnose->created_at ."</i><br>
                                        "; ?>
                                </text>
                            </p>
                            <hr>
                            <?php } } else { ?>
                            <p class="mb-1 fw-medium">Diagnosis Name:
                                <span class="fw-light float-end text-success">None</span>
                            </p>
                            <?php } ?>

                            <!-- Fetch surgery infos ... -->
                            <?php # Fetching diagnosis infos location info ...

                                $patient_id = $patientResults->patient_id;

                                $surgery_FetchQuery = 'SELECT * FROM `surgery_form` WHERE `patient_id` = :patient_id AND `status` = :bstatus';
                                # $surgery_FetchQuery = 'SELECT * FROM `surgery_form` WHERE `patient_id` = :patient_id';
                                $surgery_FetchStatement = $pdo->prepare($surgery_FetchQuery);
                                $surgery_FetchStatement->execute([
                                            'patient_id'  =>  $patient_id,
                                            'bstatus'     =>  'unpaid'
                                        ]);
                                $surgery_Result = $surgery_FetchStatement->fetchAll();

                                if ($surgery_Result) {
                                
                                foreach ($surgery_Result as $key => $surgery) {
                            ?>
                            <p class="mb-1 fw-medium">Surgery Description:
                                <text class="fw-light">
                                    <?php echo "
                                        <span class='float-end text-success fw-bold'>".$surgery->description . " (Description)</span><br>
                                        <i class='float-end'>".$surgery->complications . " (Complications)</i><br>
                                        <i class='float-end'>".$surgery->allergy . " (Allergy)</i><br>
                                        <i class='float-end text-capitalize text-danger'>". $surgery->status ." (". number_format($surgery_fee) ." Rwf)</i><br>
                                        <i class='float-end'> On ". $surgery->created_on ." at ". $surgery->created_at ."</i><br>
                                        "; ?>
                                </text>
                            </p>
                            <hr>
                            <?php } } else { ?>
                            <p class="mb-1 fw-medium">Surgery Description:
                                <span class="fw-light float-end text-success">None</span>
                            </p>
                            <?php } ?>

                            <a href="#signin" class="btn btn-gold bi-eye float-end"> View More</a>

                        </div>

                        <!-- if not searched -->
                        <?php } else { ?>
                        <div class="card-header d-md-inline-flex d-block placeholder-glow">
                            <img src="public/img/user_photo.png" class="img-thumbnail col-lg-3 col-md-3 placeholder" alt="...">
                            <h5 class="col-9 d-md-block d-none ms-2 card-text placeholder-glow">
                                <span class="placeholder col-12"></span>
                                <span class="placeholder col-9"></span>
                                <span class="placeholder col-10"></span>
                                <span class="placeholder col-11"></span>
                                <span class="placeholder col-12"></span>
                            </h5>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title placeholder-glow">
                                <span class="placeholder col-6 bg-success"></span>
                            </h5>
                            <p class="card-text placeholder-glow">
                                <span class="placeholder col-7"></span>
                                <span class="placeholder col-4"></span>
                                <span class="placeholder col-4"></span>
                                <span class="placeholder col-6"></span>
                                <span class="placeholder col-8"></span>
                            </p>
                            <a class="btn btn-altprimary disabled placeholder col-6" aria-disabled="true"></a>
                        </div>
                        <?php } ?>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- get updates / modal trigger -->
    <section class="bg-althospital">
        <footer class="lead text-center">
            <p>
                &copy; Copyrights 2023
            </p>
        </footer>
    </section>

    <!-- offcanvas for register -->
    <div class="offcanvas offcanvas-top bg-altprimary" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
        <div class="offcanvas-header">
            <h3 class="offcanvas-title text-uppercase fw-medium text-altlight bi-view-stacked" id="offcanvasExampleLabel"> Explore other options</h3>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div>
                <p class="text-muted">Become a pharmacy partner or land a job with us.</p>
                <!-- <p class="text-muted">Use link below!</p> -->
            </div>
            <a href="#signin" class="btn btn-gold bi-people" data-bs-toggle="modal" data-bs-target="#aregisterModal" data-bs-whatever="@aregister"><span class="d-lg-inline-block">&nbsp;Land a Job</span></a>

            <a href="#signin" class="btn btn-gold bi-buildings" data-bs-toggle="modal" data-bs-target="#bregisterModal" data-bs-whatever="@register"><span class="d-lg-inline-block">&nbsp;Become our patient</span></a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <script>
        const tooltips = document.querySelectorAll('.tt')
        tooltips.forEach(t => {
            new bootstrap.Tooltip(t)
        })
    </script>
</body>

</html>